{% extends 'base.html' %}
{% load static %}

{% block title %}Darf Vermieter Das? | KI-gestützte Mietvertragsanalyse{% endblock %}

{% block content %}
    <div class="quantum-container">
        <!-- Hero Section -->
        <section class="hero-section position-relative overflow-hidden">
            <div class="container">
                <div class="row align-items-center hero-wrapper">
                    <!-- Left Side - Content -->
                    <div class="col-lg-6 hero-content-wrapper">
                        <div class="hero-content">
                            <h1 class="hero-title display-4 fw-bold mb-4">Mietverträge prüfen mit <span
                                    class="hero-highlight position-relative">KI</span></h1>
                            <p class="hero-subtitle lead mb-4">Erhalten Sie in Sekunden einen Überblick über Ihre
                                Mietrechte – dank unserer KI-Analyse<a href="#disclaimer">*</a></p>

                            <div class="hero-stats d-flex flex-wrap gap-4 mb-5">
                                <div class="stat-item pe-4 border-end border-2">
                                    <span class="stat-number d-block">ab 0€</span>
                                    <span class="stat-text">Kostenlose Basisanalyse</span>
                                </div>
                                <div class="stat-item pe-4 border-end border-2">
                                    <span class="stat-number d-block"><15s</span>
                                    <span class="stat-text">Analysezeit</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number d-block">3 Klicks</span>
                                    <span class="stat-text">zur Analyse</span>
                                </div>
                            </div>

                            <div class="d-flex flex-wrap gap-3 mb-4">
                                <button class="btn btn-primary btn-lg pulse-animation" x-data
                                        x-on:click="scrollAndHighlightUploadForm()">
                                    <i class="bi bi-file-earmark-text me-2"></i>Jetzt Mietvertrag prüfen
                                </button>
                                <a href="#how-it-works" class="btn btn-outline-secondary btn-lg">
                                    Mehr erfahren <i class="bi bi-arrow-right ms-1"></i>
                                </a>
                            </div>

                            <div class="d-flex flex-wrap gap-3 mt-4 security-badges">
                                <div class="security-badge d-flex align-items-center">
                                    <i class="bi bi-shield-check me-2 text-success"></i>
                                    <span>SSL verschlüsselt</span>
                                </div>
                                <div class="security-badge d-flex align-items-center">
                                    <i class="bi bi-eye-slash me-2 text-success"></i>
                                    <span>DSGVO-orientiert</span>
                                </div>
                                <div class="security-badge d-flex align-items-center">
                                    <i class="bi bi-trash me-2 text-success"></i>
                                    <span>Verträge werden nach Analyse gelöscht</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Side - Upload Form -->
                    <div class="col-lg-6 mt-5 mt-lg-0">
                        <section class="upload-form-wrapper bg-white p-3 p-lg-4 rounded-4 shadow"
                                 id="upload-form-section">
                            <h3 class="mb-4 text-center">Hochladen & Analysieren</h3>
                            <div class="upload-form">
                                {% include 'contract/upload.html' %}
                            </div>
                        </section>
                    </div>
                </div>
            </div>

            <!-- Background decorative elements -->
            <div class="position-absolute bg-blob-1"></div>
            <div class="position-absolute bg-blob-2"></div>
        </section>

        <!-- Features Section -->
        <section class="section" id="functions">
            <div class="section-header">
                <h2>Was unsere KI erkennt</h2>
                <p>Wir bringen Mietverträge auf den Punkt – schnell und übersichtlich</p>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon-wrapper">
                        <i class="bi bi-cash-coin"></i>
                    </div>
                    <h3>Mieterhöhungen</h3>
                    <p>Überprüfung auf überhöhte Erhöhungen und versteckte Kosten.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon-wrapper">
                        <i class="bi bi-tools"></i>
                    </div>
                    <h3>Renovierungsklauseln</h3>
                    <p>Erkennung von Klauseln zu Schönheitsreparaturen, die nicht wirksam sind.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon-wrapper">
                        <i class="bi bi-house-door"></i>
                    </div>
                    <h3>Nebenkosten</h3>
                    <p>Aufspüren von Möglichkeiten zur ungerechtfertigten Umlage.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon-wrapper">
                        <i class="bi bi-calendar-x"></i>
                    </div>
                    <h3>Kündigungsfristen</h3>
                    <p>Prüfung der vereinbarten Fristen und Bedingungen.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon-wrapper">
                        <i class="bi bi-shield-exclamation"></i>
                    </div>
                    <h3>Haftungsklauseln</h3>
                    <p>Analyse von Regeln zur Haftungsverteilung im Vertrag.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon-wrapper">
                        <i class="bi bi-file-earmark-text"></i>
                    </div>
                    <h3>Vertragsgesamtheit</h3>
                    <p>Bewertung des Vertrags als Ganzes auf seine Fairness und Angemessenheit.</p>
                </div>
            </div>
        </section>

        <!-- How It Works -->
        <section class="section how-it-works" id="how-it-works">
            <div class="section-header">
                <h2>So einfach geht's</h2>
                <p>In drei Schritten zu Ihrem ersten Überblick</p>
            </div>

            <div class="steps-container">
                <div class="step-item">
                    <div class="step-number">01</div>
                    <div class="step-content">
                        <h3>Mietvertrag hochladen</h3>
                        <p>Laden Sie Ihren Mietvertrag als PDF oder Foto hoch.</p>
                    </div>
                    <div class="step-icon">
                        <i class="bi bi-cloud-arrow-up"></i>
                    </div>
                </div>

                <div class="step-connector"></div>

                <div class="step-item">
                    <div class="step-number">02</div>
                    <div class="step-content">
                        <h3>Analyse starten</h3>
                        <p>Unsere Technologie prüft den Vertrag auf wichtige Punkte und mögliche kritische Klauseln.</p>
                    </div>
                    <div class="step-icon">
                        <i class="bi bi-cpu"></i>
                    </div>
                </div>

                <div class="step-connector"></div>

                <div class="step-item">
                    <div class="step-number">03</div>
                    <div class="step-content">
                        <h3>Ergebnis abrufen</h3>
                        <p>Erhalten Sie eine Übersicht mit zentralen Erkenntnissen und Anhaltspunkten.</p>
                    </div>
                    <div class="step-icon">
                        <i class="bi bi-file-earmark-check"></i>
                    </div>
                </div>
            </div>
        </section>

        <!-- Testimonials -->
        <section class="section" id="testimonials">
            <div class="section-header">
                <h2>Was unsere Nutzer sagen</h2>
                <p>Tausende Mieter vertrauen bereits auf unsere KI-Analyse</p>
            </div>

            <div class="testimonials-container" id="testimonials-carousel">
                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                    </div>
                    <p class="testimonial-text">"Die KI hat in meinem Vertrag drei ungültige Klauseln gefunden. Dank der
                        Handlungsempfehlungen konnte ich 240€ pro Jahr sparen!"</p>
                    <div class="testimonial-author">
                        <img src="" alt="Marie S.">
                        <div>
                            <h4>Marie S.</h4>
                            <span>Berlin</span>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                    </div>
                    <p class="testimonial-text">"Schnell, präzise und verständlich erklärt. Die Renovierungsklausel in
                        meinem Vertrag war unwirksam. Das hat mir viel Geld und Ärger erspart."</p>
                    <div class="testimonial-author">
                        <img src="" alt="Thomas K.">
                        <div>
                            <h4>Thomas K.</h4>
                            <span>München</span>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star"></i>
                    </div>
                    <p class="testimonial-text">"Als Jurastudentin bin ich beeindruckt von der Genauigkeit. Die KI hat
                        sogar Details gefunden, die mir nicht aufgefallen wären."</p>
                    <div class="testimonial-author">
                        <img src="" alt="Laura M.">
                        <div>
                            <h4>Laura M.</h4>
                            <span>Hamburg</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="testimonial-controls">
                <button id="prev-testimonial"><i class="bi bi-chevron-left"></i></button>
                <button id="next-testimonial"><i class="bi bi-chevron-right"></i></button>
            </div>
        </section>

        <!-- Benefits Section -->
        <section class="section" id="benefits">
            <div class="section-header">
                <h2>Ihre Vorteile</h2>
                <p>Warum immer mehr Mieter auf unsere Analyse vertrauen</p>
            </div>

            <div class="benefits-container">
                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="bi bi-lightning"></i>
                    </div>
                    <h3>Schnelle Ergebnisse</h3>
                    <p>Erhalten Sie Ihre Analyse in unter 60 Sekunden – direkt auf den Punkt gebracht.</p>
                </div>

                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="bi bi-piggy-bank"></i>
                    </div>
                    <h3>Kosteneffizienz</h3>
                    <p>Eine preiswerte Möglichkeit, wichtige Vertragsinformationen zu entdecken.</p>
                </div>

                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="bi bi-translate"></i>
                    </div>
                    <h3>Klare Sprache</h3>
                    <p>Komplexe Texte werden verständlich und übersichtlich aufbereitet.</p>
                </div>

                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="bi bi-graph-up"></i>
                    </div>
                    <h3>Immer aktuell</h3>
                    <p>Durch regelmäßige Updates erhalten Sie stets die wichtigsten Informationen.</p>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="section faq-section" id="faq">
            <div class="section-header">
                <h2>Häufig gestellte Fragen</h2>
                <p>Antworten auf Ihre wichtigsten Fragen</p>
            </div>

            <div class="accordion-wrapper">
                <div class="accordion" id="landingFaq">
                    {% for item in faq %}
                        <div class="accordion-item">
                            <div class="accordion-header" id="faqHeading{{ forloop.counter }}">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#faq{{ forloop.counter }}" aria-expanded="false"
                                        aria-controls="faq{{ forloop.counter }}">
                                    {{ item.question }}
                                </button>
                            </div>
                            <div id="faq{{ forloop.counter }}" class="accordion-collapse collapse"
                                 aria-labelledby="faqHeading{{ forloop.counter }}" data-bs-parent="#landingFaq">
                                <div class="accordion-body">
                                    {{ item.answer }}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <div class="cta-content">
                <h2>Bereit, Ihren Mietvertrag zu prüfen?</h2>
                <p>Verschaffen Sie jetzt einen Überblick über Ihre Mietrechte</p>
                <button class="btn-primary btn-large" x-data x-on:click="scrollAndHighlightUploadForm()">
                    <i class="bi bi-file-earmark-text me-2"></i>Jetzt Mietvertrag prüfen
                </button>
            </div>
        </section>

        <!-- Disclaimer -->
        {% include 'disclaimer.html' %}
    </div>
{% endblock %}

{% block extra_css %}
    <style>
        .bg-blob-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(67, 97, 238, 0.05) 0%, rgba(67, 97, 238, 0) 70%);
            border-radius: 50%;
            top: -300px;
            right: -300px;
            z-index: 1;
        }

        .bg-blob-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(0, 216, 187, 0.05) 0%, rgba(0, 216, 187, 0) 70%);
            border-radius: 50%;
            bottom: -250px;
            left: -250px;
            z-index: 1;
        }

        /* Responsive adjustments */
        @media (max-width: 992px) {
            .hero-stats {
                justify-content: center;
            }

            .stat-item {
                border: none !important;
                padding: 0 1rem !important;
                text-align: center;
            }

            .security-badges {
                justify-content: center;
            }
        }
    </style>
{% endblock %}

{% block extra_js %}
    <script>
			function scrollAndHighlightUploadForm() {
				const uploadForm = document.getElementById('upload-form-section');
				if (uploadForm) {
					const offsetTop = uploadForm.offsetTop;
					window.scrollTo({
						top: offsetTop,
						behavior: 'smooth'
					});

					uploadForm.classList.add('highlight');
					uploadForm.classList.add('active');

					setTimeout(() => {
						uploadForm.classList.remove('active');
						setTimeout(() => {
							uploadForm.classList.remove('highlight');
						}, 300);
					}, 2000);
				}
			}
    </script>

    <script type="module">
			document.addEventListener('DOMContentLoaded', function () {
				// Original JS functionality remains the same
				initializeTestimonialCarousel();
				initializeFAQAccordion();
				initializeMobileMenu();
				initializeSmoothScroll();
				initializeScrollAnimations();
			});

			// Testimonial Carousel
			function initializeTestimonialCarousel() {
				const carousel = document.getElementById('testimonials-carousel');
				const prevButton = document.getElementById('prev-testimonial');
				const nextButton = document.getElementById('next-testimonial');

				if (!carousel || !prevButton || !nextButton) return;

				const testimonials = Array.from(carousel.children);
				let currentIndex = 0;
				let startX, moveX;

				// Touch-Event-Listener für mobile Geräte
				carousel.addEventListener('touchstart', (e) => {
					startX = e.touches[0].clientX;
				});

				carousel.addEventListener('touchmove', (e) => {
					if (!startX) return;
					moveX = e.touches[0].clientX;
				});

				carousel.addEventListener('touchend', () => {
					if (!startX || !moveX) return;

					const diffX = startX - moveX;

					if (diffX > 50) {
						showNextTestimonial();
					} else if (diffX < -50) {
						showPrevTestimonial();
					}

					startX = null;
					moveX = null;
				});

				// Buttons für Testimonial-Navigation
				prevButton.addEventListener('click', showPrevTestimonial);
				nextButton.addEventListener('click', showNextTestimonial);

				function showPrevTestimonial() {
					const visibleCount = getVisibleCount();
					currentIndex = Math.max(0, currentIndex - 1);
					scrollCarousel();
				}

				function showNextTestimonial() {
					const visibleCount = getVisibleCount();
					currentIndex = Math.min(testimonials.length - visibleCount, currentIndex + 1);
					scrollCarousel();
				}

				function scrollCarousel() {
					const testimonial = testimonials[currentIndex];
					const scrollPos = testimonial.offsetLeft - carousel.offsetLeft;

					carousel.scrollTo({
						left: scrollPos,
						behavior: 'smooth'
					});
				}

				function getVisibleCount() {
					const carouselWidth = carousel.offsetWidth;
					const testimonialWidth = testimonials[0].offsetWidth + parseInt(window.getComputedStyle(testimonials[0]).marginRight);
					return Math.max(1, Math.floor(carouselWidth / testimonialWidth));
				}

				// Initiales Scrollen zum ersten Element
				scrollCarousel();

				// Responsive Anpassung
				window.addEventListener('resize', scrollCarousel);
			}

			// FAQ Accordion
			function initializeFAQAccordion() {
				const faqItems = document.querySelectorAll('.accordion-item');

				faqItems.forEach(item => {
					const question = item.querySelector('.faq-question');

					question.addEventListener('click', () => {
						const isActive = item.classList.contains('active');

						// Alle schließen
						faqItems.forEach(faq => faq.classList.remove('active'));

						// Wenn es nicht aktiv war, öffnen
						if (!isActive) {
							item.classList.add('active');
						}
					});
				});
			}

			// Smooth Scroll für Anker-Links
			function initializeSmoothScroll() {
				document.querySelectorAll('a[href^="#"]').forEach(anchor => {
					anchor.addEventListener('click', function (e) {
						e.preventDefault();

						const targetId = this.getAttribute('href').substring(1);
						const targetElement = document.getElementById(targetId);

						if (targetElement) {
							window.scrollTo({
								top: targetElement.offsetTop - 80, // Abstand für Navbar
								behavior: 'smooth'
							});
						}
					});
				});
			}

			// Scroll-Animationen
			function initializeScrollAnimations() {
				const elements = document.querySelectorAll('.feature-card, .step-item, .benefit-card, .testimonial-card');

				const observer = new IntersectionObserver((entries) => {
					entries.forEach(entry => {
						if (entry.isIntersecting) {
							entry.target.classList.add('animated');
							observer.unobserve(entry.target);
						}
					});
				}, {
					threshold: 0.1
				});

				elements.forEach(element => {
					observer.observe(element);
				});

				// CSS für Animation hinzufügen
				const style = document.createElement('style');
				style.textContent = `
    .feature-card, .step-item, .benefit-card, .testimonial-card {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    }

    .feature-card.animated, .step-item.animated, .benefit-card.animated, .testimonial-card.animated {
      opacity: 1;
      transform: translateY(0);
    }
  `;
				document.head.appendChild(style);
			}
    </script>
{% endblock %}
